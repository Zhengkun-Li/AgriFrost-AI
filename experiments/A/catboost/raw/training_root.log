Output directory: experiments/A/catboost/raw
================================================================================
üöÄ Training Started
   Start Time: 2025-11-15 19:05:34
   Model Type: catboost
   Horizons: [3, 6, 12, 24]
   Output Directory: experiments/A/catboost/raw
================================================================================

============================================================
Step 1: Loading Data
[2025-11-15 19:05:34] Starting data loading...
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB
[2025-11-15 19:05:38] Step 1 completed in 3.32 seconds

============================================================
Step 2: Cleaning Data
[2025-11-15 19:05:38] Starting data cleaning...
============================================================
After cleaning: 2367360 rows
[2025-11-15 19:05:42] Step 2 completed in 3.97 seconds

============================================================
Step 3: Feature Engineering
[2025-11-15 19:05:42] Starting feature engineering...
============================================================
After feature engineering: 2367360 rows, 293 columns
Optimizing data types after feature engineering...
Memory usage after optimization: 3.84 GB
[2025-11-15 19:05:54] Step 3 completed in 12.40 seconds

============================================================
Step 4: Creating Frost Labels
============================================================
Created frost labels for horizons: [3, 6, 12, 24]
Final dataset: 2367360 rows, 301 columns

Saved labeled data to experiments/A/catboost/raw/labeled_data.parquet and experiments/A/catboost/raw/full_training/labeled_data.parquet

[2025-11-15 19:06:09] Starting model training for all horizons...

============================================================
Training models for 3h horizon
[2025-11-15 19:06:09] Starting 3h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 612 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367306
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367306
Frost events: 20579.0 (0.87%)
Train: 1657114, Val: 355096, Test: 355096

[2025-11-15 19:06:12] Training classification model for frost probability...
[2025-11-15 19:06:22] Frost classification model training completed in 9.96 seconds (0.17 minutes)

[2025-11-15 19:06:22] Training regression model for temperature...
[2025-11-15 19:06:31] Temperature regression model training completed in 9.26 seconds (0.15 minutes)

[2025-11-15 19:06:31] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9973
brier_score: 0.0020
ece: 0.0005
f1: 0.7316
fn: 579
fp: 397
pr_auc: 0.8189
precision: 0.7701
recall: 0.6967
roc_auc: 0.9983
tn: 352790
tp: 1330

Regression Metrics (Temperature):
mae: 0.8790
mape: 9.7026
r2: 0.9822
rmse: 1.1796

Generating reliability diagram...
[2025-11-15 19:06:32] Evaluation completed in 1.15 seconds

[2025-11-15 19:06:33] 3h horizon training completed in 23.61 seconds (0.39 minutes)

============================================================
Training models for 6h horizon
[2025-11-15 19:06:33] Starting 6h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 450 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367252
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367252
Frost events: 20579.0 (0.87%)
Train: 1657076, Val: 355088, Test: 355088

[2025-11-15 19:06:36] Training classification model for frost probability...
[2025-11-15 19:06:46] Frost classification model training completed in 9.91 seconds (0.17 minutes)

[2025-11-15 19:06:46] Training regression model for temperature...
[2025-11-15 19:06:55] Temperature regression model training completed in 9.26 seconds (0.15 minutes)

[2025-11-15 19:06:55] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9966
brier_score: 0.0025
ece: 0.0008
f1: 0.6772
fn: 644
fp: 562
pr_auc: 0.7539
precision: 0.6924
recall: 0.6627
roc_auc: 0.9976
tn: 352617
tp: 1265

Regression Metrics (Temperature):
mae: 1.0740
mape: 11.6452
r2: 0.9745
rmse: 1.4117

Generating reliability diagram...
[2025-11-15 19:06:56] Evaluation completed in 1.05 seconds

[2025-11-15 19:06:56] 6h horizon training completed in 22.90 seconds (0.38 minutes)

============================================================
Training models for 12h horizon
[2025-11-15 19:06:56] Starting 12h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 234 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367144
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367144
Frost events: 20579.0 (0.87%)
Train: 1657000, Val: 355072, Test: 355072

[2025-11-15 19:06:59] Training classification model for frost probability...
[2025-11-15 19:07:09] Frost classification model training completed in 10.23 seconds (0.17 minutes)

[2025-11-15 19:07:09] Training regression model for temperature...
[2025-11-15 19:07:18] Temperature regression model training completed in 9.27 seconds (0.15 minutes)

[2025-11-15 19:07:18] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9952
brier_score: 0.0035
ece: 0.0021
f1: 0.5614
fn: 824
fp: 871
pr_auc: 0.5821
precision: 0.5547
recall: 0.5684
roc_auc: 0.9939
tn: 352292
tp: 1085

Regression Metrics (Temperature):
mae: 1.7086
mape: 18.1140
r2: 0.9373
rmse: 2.2155

Generating reliability diagram...
[2025-11-15 19:07:19] Evaluation completed in 1.06 seconds

[2025-11-15 19:07:19] 12h horizon training completed in 23.25 seconds (0.39 minutes)

============================================================
Training models for 24h horizon
[2025-11-15 19:07:19] Starting 24h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 18 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2366928
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2366928
Frost events: 20579.0 (0.87%)
Train: 1656849, Val: 355039, Test: 355040

[2025-11-15 19:07:22] Training classification model for frost probability...
[2025-11-15 19:07:32] Frost classification model training completed in 10.17 seconds (0.17 minutes)

[2025-11-15 19:07:32] Training regression model for temperature...
[2025-11-15 19:07:42] Temperature regression model training completed in 9.31 seconds (0.16 minutes)

[2025-11-15 19:07:42] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9936
brier_score: 0.0048
ece: 0.0043
f1: 0.4206
fn: 1090
fp: 1166
pr_auc: 0.3993
precision: 0.4126
recall: 0.4290
roc_auc: 0.9873
tn: 351965
tp: 819

Regression Metrics (Temperature):
mae: 1.8893
mape: 22.0685
r2: 0.9223
rmse: 2.4653

Generating reliability diagram...
[2025-11-15 19:07:43] Evaluation completed in 1.02 seconds

[2025-11-15 19:07:43] 24h horizon training completed in 23.19 seconds (0.39 minutes)

[2025-11-15 19:07:43] All horizons training completed in 93.38 seconds (1.56 minutes)

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0020, ECE: 0.0005, ROC-AUC: 0.9983
  Temp  - MAE: 0.8790, RMSE: 1.1796, R¬≤: 0.9822

6h Horizon:
  Frost - Brier: 0.0025, ECE: 0.0008, ROC-AUC: 0.9976
  Temp  - MAE: 1.0740, RMSE: 1.4117, R¬≤: 0.9745

12h Horizon:
  Frost - Brier: 0.0035, ECE: 0.0021, ROC-AUC: 0.9939
  Temp  - MAE: 1.7086, RMSE: 2.2155, R¬≤: 0.9373

24h Horizon:
  Frost - Brier: 0.0048, ECE: 0.0043, ROC-AUC: 0.9873
  Temp  - MAE: 1.8893, RMSE: 2.4653, R¬≤: 0.9223

‚úÖ Training completed!
   Start Time: 2025-11-15 19:05:34
   End Time: 2025-11-15 19:07:43
   Duration: 2.14 minutes (0.04 hours)
Results saved to: experiments/A/catboost/raw
