Output directory: experiments/A/lightgbm/raw
================================================================================
üöÄ Training Started
   Start Time: 2025-11-15 18:27:13
   Model Type: lightgbm
   Horizons: [3, 6, 12, 24]
   Output Directory: experiments/A/lightgbm/raw
================================================================================

============================================================
Step 1: Loading Data
[2025-11-15 18:27:13] Starting data loading...
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB
[2025-11-15 18:27:16] Step 1 completed in 3.58 seconds

============================================================
Step 2: Cleaning Data
[2025-11-15 18:27:16] Starting data cleaning...
============================================================
After cleaning: 2367360 rows
[2025-11-15 18:27:20] Step 2 completed in 3.79 seconds

============================================================
Step 3: Feature Engineering
[2025-11-15 18:27:20] Starting feature engineering...
============================================================
After feature engineering: 2367360 rows, 293 columns
Optimizing data types after feature engineering...
Memory usage after optimization: 3.84 GB
[2025-11-15 18:27:33] Step 3 completed in 13.03 seconds

============================================================
Step 4: Creating Frost Labels
============================================================
Created frost labels for horizons: [3, 6, 12, 24]
Final dataset: 2367360 rows, 301 columns

Saved labeled data to experiments/A/lightgbm/raw/labeled_data.parquet and experiments/A/lightgbm/raw/full_training/labeled_data.parquet

[2025-11-15 18:27:48] Starting model training for all horizons...

============================================================
Training models for 3h horizon
[2025-11-15 18:27:48] Starting 3h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 612 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367306
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367306
Frost events: 20579.0 (0.87%)
Train: 1657114, Val: 355096, Test: 355096

[2025-11-15 18:27:51] Training classification model for frost probability...
[2025-11-15 18:27:54] Frost classification model training completed in 3.04 seconds (0.05 minutes)

[2025-11-15 18:27:54] Training regression model for temperature...
[2025-11-15 18:27:59] Temperature regression model training completed in 4.70 seconds (0.08 minutes)

[2025-11-15 18:27:59] Evaluating on test set...
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(

Classification Metrics (Frost Probability):
accuracy: 0.9971
brier_score: 0.0021
ece: 0.0008
f1: 0.7173
fn: 602
fp: 428
pr_auc: 0.8062
precision: 0.7533
recall: 0.6847
roc_auc: 0.9982
tn: 352759
tp: 1307

Regression Metrics (Temperature):
mae: 0.8326
mape: 9.1221
r2: 0.9836
rmse: 1.1330
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_3h/frost_classifier/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_3h/frost_classifier/config.json
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_3h/temp_regressor/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_3h/temp_regressor/config.json

Generating reliability diagram...
[2025-11-15 18:28:01] Evaluation completed in 1.76 seconds

[2025-11-15 18:28:01] 3h horizon training completed in 12.39 seconds (0.21 minutes)

============================================================
Training models for 6h horizon
[2025-11-15 18:28:01] Starting 6h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 450 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367252
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367252
Frost events: 20579.0 (0.87%)
Train: 1657076, Val: 355088, Test: 355088

[2025-11-15 18:28:04] Training classification model for frost probability...
[2025-11-15 18:28:07] Frost classification model training completed in 3.30 seconds (0.06 minutes)

[2025-11-15 18:28:07] Training regression model for temperature...
[2025-11-15 18:28:12] Temperature regression model training completed in 4.94 seconds (0.08 minutes)

[2025-11-15 18:28:12] Evaluating on test set...
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(

Classification Metrics (Frost Probability):
accuracy: 0.9963
brier_score: 0.0027
ece: 0.0011
f1: 0.6521
fn: 672
fp: 648
pr_auc: 0.7246
precision: 0.6562
recall: 0.6480
roc_auc: 0.9973
tn: 352531
tp: 1237

Regression Metrics (Temperature):
mae: 1.0277
mape: 11.0614
r2: 0.9761
rmse: 1.3680
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_6h/frost_classifier/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_6h/frost_classifier/config.json
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_6h/temp_regressor/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_6h/temp_regressor/config.json

Generating reliability diagram...
[2025-11-15 18:28:13] Evaluation completed in 1.65 seconds

[2025-11-15 18:28:13] 6h horizon training completed in 12.68 seconds (0.21 minutes)

============================================================
Training models for 12h horizon
[2025-11-15 18:28:14] Starting 12h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 234 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367144
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367144
Frost events: 20579.0 (0.87%)
Train: 1657000, Val: 355072, Test: 355072

[2025-11-15 18:28:16] Training classification model for frost probability...
[2025-11-15 18:28:20] Frost classification model training completed in 3.47 seconds (0.06 minutes)

[2025-11-15 18:28:20] Training regression model for temperature...
[2025-11-15 18:28:24] Temperature regression model training completed in 4.57 seconds (0.08 minutes)

[2025-11-15 18:28:24] Evaluating on test set...
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(

Classification Metrics (Frost Probability):
accuracy: 0.9949
brier_score: 0.0037
ece: 0.0021
f1: 0.5469
fn: 808
fp: 1016
pr_auc: 0.5783
precision: 0.5201
recall: 0.5767
roc_auc: 0.9942
tn: 352147
tp: 1101

Regression Metrics (Temperature):
mae: 1.6303
mape: 17.0672
r2: 0.9426
rmse: 2.1193
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_12h/frost_classifier/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_12h/frost_classifier/config.json
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_12h/temp_regressor/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_12h/temp_regressor/config.json

Generating reliability diagram...
[2025-11-15 18:28:26] Evaluation completed in 1.71 seconds

[2025-11-15 18:28:26] 12h horizon training completed in 12.56 seconds (0.21 minutes)

============================================================
Training models for 24h horizon
[2025-11-15 18:28:26] Starting 24h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 18 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2366928
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2366928
Frost events: 20579.0 (0.87%)
Train: 1656849, Val: 355039, Test: 355040

[2025-11-15 18:28:29] Training classification model for frost probability...
[2025-11-15 18:28:33] Frost classification model training completed in 3.55 seconds (0.06 minutes)

[2025-11-15 18:28:33] Training regression model for temperature...
[2025-11-15 18:28:37] Temperature regression model training completed in 4.84 seconds (0.08 minutes)

[2025-11-15 18:28:37] Evaluating on test set...
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/home/zhengkun-li/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMRegressor was fitted with feature names
  warnings.warn(

Classification Metrics (Frost Probability):
accuracy: 0.9925
brier_score: 0.0054
ece: 0.0048
f1: 0.3929
fn: 1042
fp: 1637
pr_auc: 0.3636
precision: 0.3462
recall: 0.4542
roc_auc: 0.9879
tn: 351494
tp: 867

Regression Metrics (Temperature):
mae: 1.8576
mape: 21.5183
r2: 0.9253
rmse: 2.4172
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_24h/frost_classifier/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_24h/frost_classifier/config.json
Model saved to experiments/A/lightgbm/raw/A/full_training/horizon_24h/temp_regressor/model.pkl
Config saved to experiments/A/lightgbm/raw/A/full_training/horizon_24h/temp_regressor/config.json

Generating reliability diagram...
[2025-11-15 18:28:39] Evaluation completed in 1.73 seconds

[2025-11-15 18:28:39] 24h horizon training completed in 12.98 seconds (0.22 minutes)

[2025-11-15 18:28:39] All horizons training completed in 50.94 seconds (0.85 minutes)

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0021, ECE: 0.0008, ROC-AUC: 0.9982
  Temp  - MAE: 0.8326, RMSE: 1.1330, R¬≤: 0.9836

6h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0011, ROC-AUC: 0.9973
  Temp  - MAE: 1.0277, RMSE: 1.3680, R¬≤: 0.9761

12h Horizon:
  Frost - Brier: 0.0037, ECE: 0.0021, ROC-AUC: 0.9942
  Temp  - MAE: 1.6303, RMSE: 2.1193, R¬≤: 0.9426

24h Horizon:
  Frost - Brier: 0.0054, ECE: 0.0048, ROC-AUC: 0.9879
  Temp  - MAE: 1.8576, RMSE: 2.4172, R¬≤: 0.9253

‚úÖ Training completed!
   Start Time: 2025-11-15 18:27:13
   End Time: 2025-11-15 18:28:39
   Duration: 1.44 minutes (0.02 hours)
Results saved to: experiments/A/lightgbm/raw
Output directory: experiments/A/lightgbm/raw
================================================================================
üöÄ Training Started
   Start Time: 2025-11-15 18:41:03
   Model Type: lightgbm
   Horizons: [3, 6, 12, 24]
   Output Directory: experiments/A/lightgbm/raw
================================================================================

============================================================
Step 1: Loading Data
[2025-11-15 18:41:03] Starting data loading...
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB
[2025-11-15 18:41:06] Step 1 completed in 3.59 seconds

============================================================
Step 2: Cleaning Data
[2025-11-15 18:41:06] Starting data cleaning...
============================================================
After cleaning: 2367360 rows
[2025-11-15 18:41:10] Step 2 completed in 3.78 seconds

============================================================
Step 3: Feature Engineering
[2025-11-15 18:41:10] Starting feature engineering...
============================================================
After feature engineering: 2367360 rows, 293 columns
Optimizing data types after feature engineering...
Memory usage after optimization: 3.84 GB
[2025-11-15 18:41:23] Step 3 completed in 13.05 seconds

============================================================
Step 4: Creating Frost Labels
============================================================
Created frost labels for horizons: [3, 6, 12, 24]
Final dataset: 2367360 rows, 301 columns

Saved labeled data to experiments/A/lightgbm/raw/labeled_data.parquet and experiments/A/lightgbm/raw/full_training/labeled_data.parquet

[2025-11-15 18:41:38] Starting model training for all horizons...

============================================================
Training models for 3h horizon
[2025-11-15 18:41:38] Starting 3h horizon training...
============================================================
‚úÖ Models for 3h already exist, loading results...
  Frost - Brier: 0.0021, ECE: 0.0008, ROC-AUC: 0.9982
  Temp  - MAE: 0.8326, RMSE: 1.1330, R¬≤: 0.9836

============================================================
Training models for 6h horizon
[2025-11-15 18:41:38] Starting 6h horizon training...
============================================================
‚úÖ Models for 6h already exist, loading results...
  Frost - Brier: 0.0027, ECE: 0.0011, ROC-AUC: 0.9973
  Temp  - MAE: 1.0277, RMSE: 1.3680, R¬≤: 0.9761

============================================================
Training models for 12h horizon
[2025-11-15 18:41:38] Starting 12h horizon training...
============================================================
‚úÖ Models for 12h already exist, loading results...
  Frost - Brier: 0.0037, ECE: 0.0021, ROC-AUC: 0.9942
  Temp  - MAE: 1.6303, RMSE: 2.1193, R¬≤: 0.9426

============================================================
Training models for 24h horizon
[2025-11-15 18:41:38] Starting 24h horizon training...
============================================================
‚úÖ Models for 24h already exist, loading results...
  Frost - Brier: 0.0054, ECE: 0.0048, ROC-AUC: 0.9879
  Temp  - MAE: 1.8576, RMSE: 2.4172, R¬≤: 0.9253

[2025-11-15 18:41:38] All horizons training completed in 0.09 seconds (0.00 minutes)

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0021, ECE: 0.0008, ROC-AUC: 0.9982
  Temp  - MAE: 0.8326, RMSE: 1.1330, R¬≤: 0.9836

6h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0011, ROC-AUC: 0.9973
  Temp  - MAE: 1.0277, RMSE: 1.3680, R¬≤: 0.9761

12h Horizon:
  Frost - Brier: 0.0037, ECE: 0.0021, ROC-AUC: 0.9942
  Temp  - MAE: 1.6303, RMSE: 2.1193, R¬≤: 0.9426

24h Horizon:
  Frost - Brier: 0.0054, ECE: 0.0048, ROC-AUC: 0.9879
  Temp  - MAE: 1.8576, RMSE: 2.4172, R¬≤: 0.9253

‚úÖ Training completed!
   Start Time: 2025-11-15 18:41:03
   End Time: 2025-11-15 18:41:38
   Duration: 0.60 minutes (0.01 hours)
Results saved to: experiments/A/lightgbm/raw
Output directory: experiments/A/lightgbm/raw
================================================================================
üöÄ Training Started
   Start Time: 2025-11-15 18:45:38
   Model Type: lightgbm
   Horizons: [3, 6, 12, 24]
   Output Directory: experiments/A/lightgbm/raw
================================================================================

============================================================
Step 1: Loading Data
[2025-11-15 18:45:38] Starting data loading...
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB
[2025-11-15 18:45:42] Step 1 completed in 3.29 seconds

============================================================
Step 2: Cleaning Data
[2025-11-15 18:45:42] Starting data cleaning...
============================================================
After cleaning: 2367360 rows
[2025-11-15 18:45:46] Step 2 completed in 3.92 seconds

============================================================
Step 3: Feature Engineering
[2025-11-15 18:45:46] Starting feature engineering...
============================================================
After feature engineering: 2367360 rows, 293 columns
Optimizing data types after feature engineering...
Memory usage after optimization: 3.84 GB
[2025-11-15 18:45:58] Step 3 completed in 12.49 seconds

============================================================
Step 4: Creating Frost Labels
============================================================
Created frost labels for horizons: [3, 6, 12, 24]
Final dataset: 2367360 rows, 301 columns

Saved labeled data to experiments/A/lightgbm/raw/labeled_data.parquet and experiments/A/lightgbm/raw/full_training/labeled_data.parquet

[2025-11-15 18:46:13] Starting model training for all horizons...

============================================================
Training models for 3h horizon
[2025-11-15 18:46:13] Starting 3h horizon training...
============================================================
‚úÖ Models for 3h already exist, loading results...
  Frost - Brier: 0.0021, ECE: 0.0008, ROC-AUC: 0.9982
  Temp  - MAE: 0.8326, RMSE: 1.1330, R¬≤: 0.9836

============================================================
Training models for 6h horizon
[2025-11-15 18:46:14] Starting 6h horizon training...
============================================================
‚úÖ Models for 6h already exist, loading results...
  Frost - Brier: 0.0027, ECE: 0.0011, ROC-AUC: 0.9973
  Temp  - MAE: 1.0277, RMSE: 1.3680, R¬≤: 0.9761

============================================================
Training models for 12h horizon
[2025-11-15 18:46:14] Starting 12h horizon training...
============================================================
‚úÖ Models for 12h already exist, loading results...
  Frost - Brier: 0.0037, ECE: 0.0021, ROC-AUC: 0.9942
  Temp  - MAE: 1.6303, RMSE: 2.1193, R¬≤: 0.9426

============================================================
Training models for 24h horizon
[2025-11-15 18:46:14] Starting 24h horizon training...
============================================================
‚úÖ Models for 24h already exist, loading results...
  Frost - Brier: 0.0054, ECE: 0.0048, ROC-AUC: 0.9879
  Temp  - MAE: 1.8576, RMSE: 2.4172, R¬≤: 0.9253

[2025-11-15 18:46:14] All horizons training completed in 0.76 seconds (0.01 minutes)

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0021, ECE: 0.0008, ROC-AUC: 0.9982
  Temp  - MAE: 0.8326, RMSE: 1.1330, R¬≤: 0.9836

6h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0011, ROC-AUC: 0.9973
  Temp  - MAE: 1.0277, RMSE: 1.3680, R¬≤: 0.9761

12h Horizon:
  Frost - Brier: 0.0037, ECE: 0.0021, ROC-AUC: 0.9942
  Temp  - MAE: 1.6303, RMSE: 2.1193, R¬≤: 0.9426

24h Horizon:
  Frost - Brier: 0.0054, ECE: 0.0048, ROC-AUC: 0.9879
  Temp  - MAE: 1.8576, RMSE: 2.4172, R¬≤: 0.9253

‚úÖ Training completed!
   Start Time: 2025-11-15 18:45:38
   End Time: 2025-11-15 18:46:14
   Duration: 0.60 minutes (0.01 hours)
Results saved to: experiments/A/lightgbm/raw
