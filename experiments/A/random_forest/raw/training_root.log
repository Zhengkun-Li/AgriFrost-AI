Output directory: experiments/A/random_forest/raw
================================================================================
üöÄ Training Started
   Start Time: 2025-11-15 19:18:40
   Model Type: random_forest
   Horizons: [3, 6, 12, 24]
   Output Directory: experiments/A/random_forest/raw
================================================================================

============================================================
Step 1: Loading Data
[2025-11-15 19:18:40] Starting data loading...
============================================================
Loading 18 station files from /home/zhengkun-li/frost-risk-forecast-challenge/data/raw/frost-risk-forecast-challenge/stations...
  Loaded 5/18 files...  Loaded 10/18 files...  Loaded 15/18 files...  Loaded 18/18 files...
Combining 18 station DataFrames...
Combined data: 2367360 rows, 26 columns
Stations: 18
Loaded 2367360 rows, 26 columns
Optimizing data types to reduce memory...
Memory usage after optimization: 1.50 GB
[2025-11-15 19:18:44] Step 1 completed in 3.34 seconds

============================================================
Step 2: Cleaning Data
[2025-11-15 19:18:44] Starting data cleaning...
============================================================
After cleaning: 2367360 rows
[2025-11-15 19:18:48] Step 2 completed in 4.08 seconds

============================================================
Step 3: Feature Engineering
[2025-11-15 19:18:48] Starting feature engineering...
============================================================
After feature engineering: 2367360 rows, 293 columns
Optimizing data types after feature engineering...
Memory usage after optimization: 3.84 GB
[2025-11-15 19:19:00] Step 3 completed in 12.47 seconds

============================================================
Step 4: Creating Frost Labels
============================================================
Created frost labels for horizons: [3, 6, 12, 24]
Final dataset: 2367360 rows, 301 columns

Saved labeled data to experiments/A/random_forest/raw/labeled_data.parquet and experiments/A/random_forest/raw/full_training/labeled_data.parquet

[2025-11-15 19:19:15] Starting model training for all horizons...

============================================================
Training models for 3h horizon
[2025-11-15 19:19:15] Starting 3h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 612 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367306
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367306
Frost events: 20579.0 (0.87%)
Train: 1657114, Val: 355096, Test: 355096

[2025-11-15 19:19:18] Training classification model for frost probability...
[2025-11-15 19:20:02] Frost classification model training completed in 44.38 seconds (0.74 minutes)

[2025-11-15 19:20:02] Training regression model for temperature...
[2025-11-15 19:22:29] Temperature regression model training completed in 146.86 seconds (2.45 minutes)

[2025-11-15 19:22:29] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9971
brier_score: 0.0022
ece: 0.0009
f1: 0.7106
fn: 642
fp: 390
pr_auc: 0.7890
precision: 0.7646
recall: 0.6637
roc_auc: 0.9978
tn: 352797
tp: 1267

Regression Metrics (Temperature):
mae: 1.0777
mape: 11.7693
r2: 0.9736
rmse: 1.4387

Generating reliability diagram...
[2025-11-15 19:22:31] Evaluation completed in 1.54 seconds

[2025-11-15 19:22:31] 3h horizon training completed in 196.05 seconds (3.27 minutes)

============================================================
Training models for 6h horizon
[2025-11-15 19:22:31] Starting 6h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 450 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367252
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367252
Frost events: 20579.0 (0.87%)
Train: 1657076, Val: 355088, Test: 355088

[2025-11-15 19:22:34] Training classification model for frost probability...
[2025-11-15 19:23:18] Frost classification model training completed in 44.37 seconds (0.74 minutes)

[2025-11-15 19:23:18] Training regression model for temperature...
[2025-11-15 19:25:48] Temperature regression model training completed in 149.97 seconds (2.50 minutes)

[2025-11-15 19:25:48] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9966
brier_score: 0.0027
ece: 0.0020
f1: 0.6283
fn: 877
fp: 344
pr_auc: 0.7034
precision: 0.7500
recall: 0.5406
roc_auc: 0.9964
tn: 352835
tp: 1032

Regression Metrics (Temperature):
mae: 1.2948
mape: 13.5840
r2: 0.9625
rmse: 1.7126

Generating reliability diagram...
[2025-11-15 19:25:50] Evaluation completed in 1.45 seconds

[2025-11-15 19:25:50] 6h horizon training completed in 198.47 seconds (3.31 minutes)

============================================================
Training models for 12h horizon
[2025-11-15 19:25:50] Starting 12h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 234 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2367144
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2367144
Frost events: 20579.0 (0.87%)
Train: 1657000, Val: 355072, Test: 355072

[2025-11-15 19:25:53] Training classification model for frost probability...
[2025-11-15 19:26:35] Frost classification model training completed in 42.80 seconds (0.71 minutes)

[2025-11-15 19:26:35] Training regression model for temperature...
[2025-11-15 19:29:03] Temperature regression model training completed in 147.62 seconds (2.46 minutes)

[2025-11-15 19:29:03] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9951
brier_score: 0.0036
ece: 0.0031
f1: 0.4045
fn: 1313
fp: 442
pr_auc: 0.4976
precision: 0.5742
recall: 0.3122
roc_auc: 0.9921
tn: 352721
tp: 596

Regression Metrics (Temperature):
mae: 1.9839
mape: 21.7253
r2: 0.9172
rmse: 2.5463

Generating reliability diagram...
[2025-11-15 19:29:04] Evaluation completed in 1.47 seconds

[2025-11-15 19:29:05] 12h horizon training completed in 194.58 seconds (3.24 minutes)

============================================================
Training models for 24h horizon
[2025-11-15 19:29:05] Starting 24h horizon training...
============================================================
  ‚ö†Ô∏è  Warning: Excluded 270 non-numeric columns: ['Stn Name', 'CIMIS Region', 'qc', 'qc.1', 'qc.2']...
  ‚ö†Ô∏è  Warning: Found 18 NaN values in features, filled using forward/backward fill
Features: 27, Samples: 2366928
Frost labels: 20579.0 positive (0.87%)
Temperature range: -9.30¬∞C to 45.60¬∞C
Features: 27
Samples: 2366928
Frost events: 20579.0 (0.87%)
Train: 1656849, Val: 355039, Test: 355040

[2025-11-15 19:29:07] Training classification model for frost probability...
[2025-11-15 19:29:50] Frost classification model training completed in 43.23 seconds (0.72 minutes)

[2025-11-15 19:29:50] Training regression model for temperature...
[2025-11-15 19:32:19] Temperature regression model training completed in 148.60 seconds (2.48 minutes)

[2025-11-15 19:32:19] Evaluating on test set...

Classification Metrics (Frost Probability):
accuracy: 0.9949
brier_score: 0.0041
ece: 0.0035
f1: 0.4100
fn: 1283
fp: 519
pr_auc: 0.4307
precision: 0.5467
recall: 0.3279
roc_auc: 0.9854
tn: 352612
tp: 626

Regression Metrics (Temperature):
mae: 1.9996
mape: 24.6233
r2: 0.9127
rmse: 2.6133

Generating reliability diagram...
[2025-11-15 19:32:21] Evaluation completed in 1.50 seconds

[2025-11-15 19:32:21] 24h horizon training completed in 196.02 seconds (3.27 minutes)

[2025-11-15 19:32:21] All horizons training completed in 785.54 seconds (13.09 minutes)

============================================================
Summary Report
============================================================

3h Horizon:
  Frost - Brier: 0.0022, ECE: 0.0009, ROC-AUC: 0.9978
  Temp  - MAE: 1.0777, RMSE: 1.4387, R¬≤: 0.9736

6h Horizon:
  Frost - Brier: 0.0027, ECE: 0.0020, ROC-AUC: 0.9964
  Temp  - MAE: 1.2948, RMSE: 1.7126, R¬≤: 0.9625

12h Horizon:
  Frost - Brier: 0.0036, ECE: 0.0031, ROC-AUC: 0.9921
  Temp  - MAE: 1.9839, RMSE: 2.5463, R¬≤: 0.9172

24h Horizon:
  Frost - Brier: 0.0041, ECE: 0.0035, ROC-AUC: 0.9854
  Temp  - MAE: 1.9996, RMSE: 2.6133, R¬≤: 0.9127

‚úÖ Training completed!
   Start Time: 2025-11-15 19:18:40
   End Time: 2025-11-15 19:32:21
   Duration: 13.68 minutes (0.23 hours)
Results saved to: experiments/A/random_forest/raw
